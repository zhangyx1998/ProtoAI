[
  {
    "title": "MSP Request (Host→Device): Command 0x01 (no payload)",
    "description": "Controller requests command 0x01 using MSP-like framing ($M< len cmd ... xor).",
    "confidence": 0.98,
    "fields": [
      { "name": "Sync", "description": "Fixed start byte '$' (0x24).", "range": [0, 7] },
      { "name": "ProtocolID", "description": "Fixed 'M' (0x4D).", "range": [8, 15] },
      { "name": "Direction", "description": "Host→Device indicator '<' (0x3C).", "range": [16, 23] },
      { "name": "Length", "description": "Number of payload bytes (0).", "range": [24, 31] },
      { "name": "CommandID", "description": "Command identifier (0x01).", "range": [32, 39] },
      { "name": "Checksum", "description": "XOR of Length, CommandID, and payload (0x01).", "range": [40, 47] }
    ]
  },
  {
    "title": "MSP Response (Device→Host): Command 0x01 (version triplet)",
    "description": "Device responds to command 0x01 with 3-byte payload, consistent with version fields.",
    "confidence": 0.95,
    "fields": [
      { "name": "Sync", "description": "Fixed start byte '$' (0x24).", "range": [0, 7] },
      { "name": "ProtocolID", "description": "Fixed 'M' (0x4D).", "range": [8, 15] },
      { "name": "Direction", "description": "Device→Host indicator '>' (0x3E).", "range": [16, 23] },
      { "name": "Length", "description": "Number of payload bytes (3).", "range": [24, 31] },
      { "name": "CommandID", "description": "Command identifier mirrored from request (0x01).", "range": [32, 39] },
      { "name": "VersionMajor", "description": "Major version (0x00).", "range": [40, 47] },
      { "name": "VersionMinor", "description": "Minor version (0x01).", "range": [48, 55] },
      { "name": "VersionPatch", "description": "Patch/build (0x2D = 45).", "range": [56, 63] },
      { "name": "Checksum", "description": "XOR of Length, CommandID, and payload (0x2E).", "range": [64, 71] }
    ]
  },
  {
    "title": "MSP Request (Host→Device): Command 0x04 (no payload)",
    "description": "Controller requests command 0x04 using MSP-like framing ($M< len cmd ... xor).",
    "confidence": 0.98,
    "fields": [
      { "name": "Sync", "description": "Fixed start byte '$' (0x24).", "range": [0, 7] },
      { "name": "ProtocolID", "description": "Fixed 'M' (0x4D).", "range": [8, 15] },
      { "name": "Direction", "description": "Host→Device indicator '<' (0x3C).", "range": [16, 23] },
      { "name": "Length", "description": "Number of payload bytes (0).", "range": [24, 31] },
      { "name": "CommandID", "description": "Command identifier (0x04).", "range": [32, 39] },
      { "name": "Checksum", "description": "XOR of Length, CommandID, and payload (0x04).", "range": [40, 47] }
    ]
  },
  {
    "title": "MSP Response (Device→Host): Command 0x04 (ASCII identifier)",
    "description": "Device responds to command 0x04 with 4-byte ASCII string 'BETA'.",
    "confidence": 0.97,
    "fields": [
      { "name": "Sync", "description": "Fixed start byte '$' (0x24).", "range": [0, 7] },
      { "name": "ProtocolID", "description": "Fixed 'M' (0x4D).", "range": [8, 15] },
      { "name": "Direction", "description": "Device→Host indicator '>' (0x3E).", "range": [16, 23] },
      { "name": "Length", "description": "Number of payload bytes (4).", "range": [24, 31] },
      { "name": "CommandID", "description": "Command identifier mirrored from request (0x04).", "range": [32, 39] },
      { "name": "IdentifierChar0", "description": "ASCII 'B' (0x42).", "range": [40, 47] },
      { "name": "IdentifierChar1", "description": "ASCII 'E' (0x45).", "range": [48, 55] },
      { "name": "IdentifierChar2", "description": "ASCII 'T' (0x54).", "range": [56, 63] },
      { "name": "IdentifierChar3", "description": "ASCII 'A' (0x41).", "range": [64, 71] },
      { "name": "Checksum", "description": "XOR of Length, CommandID, and payload (0x12).", "range": [72, 79] }
    ]
  },
  {
    "title": "MSP Request (Host→Device): Command 0x4D with 1-byte argument",
    "description": "Controller sends command 0x4D with parameter 0x02; timing aligns with a motion directive (likely 'forward').",
    "confidence": 0.8,
    "fields": [
      { "name": "Sync", "description": "Fixed start byte '$' (0x24).", "range": [0, 7] },
      { "name": "ProtocolID", "description": "Fixed 'M' (0x4D).", "range": [8, 15] },
      { "name": "Direction", "description": "Host→Device indicator '<' (0x3C).", "range": [16, 23] },
      { "name": "Length", "description": "Number of payload bytes (1).", "range": [24, 31] },
      { "name": "CommandID", "description": "Command identifier (0x4D).", "range": [32, 39] },
      { "name": "Parameter0", "description": "Action/mode code (0x02; likely 'forward' based on contextual hint).", "range": [40, 47] },
      { "name": "Checksum", "description": "XOR of Length, CommandID, and payload (0x4E).", "range": [48, 55] }
    ]
  }
]